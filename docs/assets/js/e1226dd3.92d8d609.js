(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{175:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return p})),t.d(n,"default",(function(){return s}));var a=t(3),i=t(8),r=(t(0),t(191)),o={id:"actions-php",title:"PHP actions",sidebar_label:"PHP actions",slug:"/actions-php"},c={unversionedId:"actions-php",id:"actions-php",isDocsHomePage:!1,title:"PHP actions",description:"The process of creating PHP actions is similar to that of other actions.",source:"@site/content/actions-php.md",slug:"/actions-php",permalink:"/docs/actions-php",editUrl:"https://github.com/hypi-universe/docs/edit/master/content/actions-php.md",version:"current",sidebar_label:"PHP actions",sidebar:"docs",previous:{title:"Go actions",permalink:"/docs/actions-go"},next:{title:"Ruby actions",permalink:"/docs/actions-ruby"}},p=[{value:"Packaging PHP actions in zip files",id:"packaging-php-actions-in-zip-files",children:[]},{value:"Including Composer dependencies",id:"including-composer-dependencies",children:[]},{value:"Built-in PHP extensions",id:"built-in-php-extensions",children:[]}],l={toc:p};function s(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The process of creating PHP actions is similar to that of ",Object(r.b)("a",{parentName:"p",href:"/docs/openwhisk-actions#the-basics"},"other actions"),"."),Object(r.b)("p",null,"The following sections guide you through creating and invoking a single PHP action,\nand demonstrate how to bundle multiple PHP files and third party dependencies."),Object(r.b)("p",null,"PHP actions are executed using PHP 8.0, 7.4 or 7.3. The specific version of PHP is listed in the CHANGELOG files in the ",Object(r.b)("a",{parentName:"p",href:"https://github.com/apache/openwhisk-runtime-php"},"PHP runtime repository"),"."),Object(r.b)("p",null,"To use a PHP runtime, specify the ",Object(r.b)("inlineCode",{parentName:"p"},"wsk")," CLI parameter ",Object(r.b)("inlineCode",{parentName:"p"},"--kind")," when creating or\nupdating an action. The available PHP kinds are:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"PHP 8.0: ",Object(r.b)("inlineCode",{parentName:"li"},"--kind php:8.0")),Object(r.b)("li",{parentName:"ul"},"PHP 7.4: ",Object(r.b)("inlineCode",{parentName:"li"},"--kind php:7.4")),Object(r.b)("li",{parentName:"ul"},"PHP 7.3: ",Object(r.b)("inlineCode",{parentName:"li"},"--kind php:7.3"))),Object(r.b)("p",null,"An action is simply a top-level PHP function. For example, create a file called ",Object(r.b)("inlineCode",{parentName:"p"},"hello.php"),"\nwith the following source code:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},'<?php\nfunction main(array $args) : array\n{\n    $name = $args["name"] ?? "stranger";\n    $greeting = "Hello $name!";\n    echo $greeting;\n    return ["greeting" => $greeting];\n}\n')),Object(r.b)("p",null,"PHP actions always consume an associative array and return an associative array."),Object(r.b)("p",null,"The entry method for the action is ",Object(r.b)("inlineCode",{parentName:"p"},"main")," by default but may be specified explicitly when creating\nthe action with the ",Object(r.b)("inlineCode",{parentName:"p"},"wsk")," CLI using ",Object(r.b)("inlineCode",{parentName:"p"},"--main"),", as with any other action type."),Object(r.b)("p",null,"You can create an OpenWhisk action called ",Object(r.b)("inlineCode",{parentName:"p"},"helloPHP")," from this function as follows:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"wsk action create helloPHP hello.php\n")),Object(r.b)("p",null,"The CLI automatically infers the type of the action from the source file extension.\nFor ",Object(r.b)("inlineCode",{parentName:"p"},".php")," source files, the action runs using a PHP 7.4 runtime."),Object(r.b)("p",null,"Action invocation is the same for PHP actions as it is for ",Object(r.b)("a",{parentName:"p",href:"/docs/openwhisk-actions#the-basics"},"any other action"),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"wsk action invoke --result helloPHP --param name World\n")),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-json"},'{\n  "greeting": "Hello World!"\n}\n')),Object(r.b)("p",null,"Find out more about parameters in the ",Object(r.b)("a",{parentName:"p",href:"/docs/openwhisk-parameters"},"Working with parameters")," section."),Object(r.b)("h3",{id:"packaging-php-actions-in-zip-files"},"Packaging PHP actions in zip files"),Object(r.b)("p",null,"You can package a PHP action along with other files and dependent packages in a zip file.\nThe filename of the source file containing the entry point (e.g., ",Object(r.b)("inlineCode",{parentName:"p"},"main"),") must be ",Object(r.b)("inlineCode",{parentName:"p"},"index.php"),".\nFor example, to create an action that includes a second file called ",Object(r.b)("inlineCode",{parentName:"p"},"helper.php"),",\nfirst create an archive containing your source files:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"zip -r helloPHP.zip index.php helper.php\n")),Object(r.b)("p",null,"and then create the action:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"wsk action create helloPHP --kind php:7.4 helloPHP.zip\n")),Object(r.b)("h3",{id:"including-composer-dependencies"},"Including Composer dependencies"),Object(r.b)("p",null,"If your PHP action requires ",Object(r.b)("a",{parentName:"p",href:"https://getcomposer.org"},"Composer")," dependencies, you can install them as usual using ",Object(r.b)("inlineCode",{parentName:"p"},"composer require")," which will create a ",Object(r.b)("inlineCode",{parentName:"p"},"vendor")," directory."),Object(r.b)("p",null,"Add this directory to your action's zip file and create the action:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"zip -r helloPHP.zip index.php vendor\nwsk action create helloPHP --kind php:7.4 helloPHP.zip\n")),Object(r.b)("p",null,"The PHP runtime will automatically include Composer's autoloader for you, so you can immediately\nuse the dependencies in your action code. Note that if you don't include your own ",Object(r.b)("inlineCode",{parentName:"p"},"vendor")," folder,\nthen the runtime will include one for you with the following Composer packages:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"guzzlehttp/guzzle"),Object(r.b)("li",{parentName:"ul"},"ramsey/uuid")),Object(r.b)("p",null,"The specific versions of these packages depends on the PHP runtime in use and is listed in the\nCHANGELOG files in the ",Object(r.b)("a",{parentName:"p",href:"https://github.com/apache/openwhisk-runtime-php"},"PHP runtime repository"),"."),Object(r.b)("h3",{id:"built-in-php-extensions"},"Built-in PHP extensions"),Object(r.b)("p",null,"The following PHP extensions are available in addition to the standard ones:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"bcmath"),Object(r.b)("li",{parentName:"ul"},"curl"),Object(r.b)("li",{parentName:"ul"},"gd"),Object(r.b)("li",{parentName:"ul"},"intl"),Object(r.b)("li",{parentName:"ul"},"mbstring"),Object(r.b)("li",{parentName:"ul"},"mongodb"),Object(r.b)("li",{parentName:"ul"},"mysqli"),Object(r.b)("li",{parentName:"ul"},"pdo_mysql"),Object(r.b)("li",{parentName:"ul"},"pdo_pgsql"),Object(r.b)("li",{parentName:"ul"},"pdo_sqlite"),Object(r.b)("li",{parentName:"ul"},"soap"),Object(r.b)("li",{parentName:"ul"},"zip")),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"Large portions of this page is copied from the ",Object(r.b)("a",{parentName:"p",href:"https://github.com/apache/openwhisk/tree/master/docs"},"Apache OpenWhisk documentation")," on April 23rd 2021 - where there have been customisations to match Hypi's deployment this has been noted. Apache OpenWhisk and the Apache name are the property of the Apache Foundation and licensed under the ",Object(r.b)("a",{parentName:"p",href:"https://github.com/apache/openwhisk/blob/master/LICENSE.txt"},"Apache V2 license")," ."))))}s.isMDXComponent=!0},191:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return h}));var a=t(0),i=t.n(a);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=i.a.createContext({}),s=function(e){var n=i.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},b=function(e){var n=s(e.components);return i.a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},d=i.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),b=s(t),d=a,h=b["".concat(o,".").concat(d)]||b[d]||u[d]||r;return t?i.a.createElement(h,c(c({ref:n},l),{},{components:t})):i.a.createElement(h,c({ref:n},l))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=d;var c={};for(var p in n)hasOwnProperty.call(n,p)&&(c[p]=n[p]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<r;l++)o[l]=t[l];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);